<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Event History Modeling: A Guide for Social Scientists</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Event History Modeling: A Guide for Social Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Event History Modeling: A Guide for Social Scientists" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Janet M. Box-Steffensmeier, Bradford S. Jones, David Darmofal">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="models-for-discrete-data.html">
<link rel="next" href="inclusion-of-time-varying-covariates.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="event-history-and-social-science.html"><a href="event-history-and-social-science.html"><i class="fa fa-check"></i><b>1</b> Event History and Social Science</a></li>
<li class="chapter" data-level="2" data-path="the-logic-of-event-history-analysis.html"><a href="the-logic-of-event-history-analysis.html"><i class="fa fa-check"></i><b>2</b> The Logic of Event History Analysis</a></li>
<li class="chapter" data-level="3" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html"><i class="fa fa-check"></i><b>3</b> Parametric Models for Single-Spell Duration Data</a><ul>
<li class="chapter" data-level="3.1" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#un-data-in-r"><i class="fa fa-check"></i><b>3.1</b> UN Data in R</a><ul>
<li class="chapter" data-level="3.1.1" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#table-3.1"><i class="fa fa-check"></i><b>3.1.1</b> Table 3.1</a></li>
<li class="chapter" data-level="3.1.2" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#figure-3.1"><i class="fa fa-check"></i><b>3.1.2</b> Figure 3.1</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#un-data-in-stata"><i class="fa fa-check"></i><b>3.2</b> UN Data in Stata</a><ul>
<li class="chapter" data-level="3.2.1" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#table-3.1-1"><i class="fa fa-check"></i><b>3.2.1</b> Table 3.1</a></li>
<li class="chapter" data-level="3.2.2" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#figure-3.1-1"><i class="fa fa-check"></i><b>3.2.2</b> Figure 3.1</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#cabinet-data-in-r"><i class="fa fa-check"></i><b>3.3</b> Cabinet Data in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#table-3.3"><i class="fa fa-check"></i><b>3.3.1</b> Table 3.3</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#cabinet-data-in-stata"><i class="fa fa-check"></i><b>3.4</b> Cabinet Data in Stata</a><ul>
<li class="chapter" data-level="3.4.1" data-path="parametric-models-for-single-spell-duration-data.html"><a href="parametric-models-for-single-spell-duration-data.html#table-3.3-1"><i class="fa fa-check"></i><b>3.4.1</b> Table 3.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html"><i class="fa fa-check"></i><b>4</b> The Cox Proportional Hazards Model</a><ul>
<li class="chapter" data-level="4.1" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html#cabinet-data-in-r-1"><i class="fa fa-check"></i><b>4.1</b> Cabinet Data in R</a><ul>
<li class="chapter" data-level="4.1.1" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html#table-4.4"><i class="fa fa-check"></i><b>4.1.1</b> Table 4.4</a></li>
<li class="chapter" data-level="4.1.2" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html#table-4.5"><i class="fa fa-check"></i><b>4.1.2</b> Table 4.5</a></li>
<li class="chapter" data-level="4.1.3" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html#figure-4.1"><i class="fa fa-check"></i><b>4.1.3</b> Figure 4.1</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html#cabinet-data-in-stata-1"><i class="fa fa-check"></i><b>4.2</b> Cabinet Data in Stata</a><ul>
<li class="chapter" data-level="4.2.1" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html#table-4.4-1"><i class="fa fa-check"></i><b>4.2.1</b> Table 4.4</a></li>
<li class="chapter" data-level="4.2.2" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html#table-4.5-1"><i class="fa fa-check"></i><b>4.2.2</b> Table 4.5</a></li>
<li class="chapter" data-level="4.2.3" data-path="the-cox-proportional-hazards-model.html"><a href="the-cox-proportional-hazards-model.html#figure-4.1-1"><i class="fa fa-check"></i><b>4.2.3</b> Figure 4.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="models-for-discrete-data.html"><a href="models-for-discrete-data.html"><i class="fa fa-check"></i><b>5</b> Models for Discrete Data</a><ul>
<li class="chapter" data-level="5.1" data-path="models-for-discrete-data.html"><a href="models-for-discrete-data.html#militarized-interventions-data-in-r"><i class="fa fa-check"></i><b>5.1</b> Militarized Interventions Data in R</a><ul>
<li class="chapter" data-level="5.1.1" data-path="models-for-discrete-data.html"><a href="models-for-discrete-data.html#table-5.3"><i class="fa fa-check"></i><b>5.1.1</b> Table 5.3</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="models-for-discrete-data.html"><a href="models-for-discrete-data.html#militarized-interventions-data-in-stata"><i class="fa fa-check"></i><b>5.2</b> Militarized Interventions Data in Stata</a><ul>
<li class="chapter" data-level="5.2.1" data-path="models-for-discrete-data.html"><a href="models-for-discrete-data.html#table-5.3-1"><i class="fa fa-check"></i><b>5.2.1</b> Table 5.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="issues-in-model-selection.html"><a href="issues-in-model-selection.html"><i class="fa fa-check"></i><b>6</b> Issues in Model Selection</a><ul>
<li class="chapter" data-level="6.1" data-path="issues-in-model-selection.html"><a href="issues-in-model-selection.html#restrictive-abortion-legislation-data-in-r"><i class="fa fa-check"></i><b>6.1</b> Restrictive Abortion Legislation Data in R</a><ul>
<li class="chapter" data-level="6.1.1" data-path="issues-in-model-selection.html"><a href="issues-in-model-selection.html#table-6.1"><i class="fa fa-check"></i><b>6.1.1</b> Table 6.1</a></li>
<li class="chapter" data-level="6.1.2" data-path="issues-in-model-selection.html"><a href="issues-in-model-selection.html#figure-6.1"><i class="fa fa-check"></i><b>6.1.2</b> Figure 6.1</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="issues-in-model-selection.html"><a href="issues-in-model-selection.html#restrictive-abortion-legislation-data-in-stata"><i class="fa fa-check"></i><b>6.2</b> Restrictive Abortion Legislation Data in Stata</a><ul>
<li class="chapter" data-level="6.2.1" data-path="issues-in-model-selection.html"><a href="issues-in-model-selection.html#table-6.1-1"><i class="fa fa-check"></i><b>6.2.1</b> Table 6.1</a></li>
<li class="chapter" data-level="6.2.2" data-path="issues-in-model-selection.html"><a href="issues-in-model-selection.html#figure-6.1-1"><i class="fa fa-check"></i><b>6.2.2</b> Figure 6.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inclusion-of-time-varying-covariates.html"><a href="inclusion-of-time-varying-covariates.html"><i class="fa fa-check"></i><b>7</b> Inclusion of Time-Varying Covariates</a><ul>
<li class="chapter" data-level="7.1" data-path="inclusion-of-time-varying-covariates.html"><a href="inclusion-of-time-varying-covariates.html#warchest-data-in-stata"><i class="fa fa-check"></i><b>7.1</b> Warchest Data in Stata</a><ul>
<li class="chapter" data-level="7.1.1" data-path="inclusion-of-time-varying-covariates.html"><a href="inclusion-of-time-varying-covariates.html#tables-7.4-and-7.5"><i class="fa fa-check"></i><b>7.1.1</b> Tables 7.4 and 7.5</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="inclusion-of-time-varying-covariates.html"><a href="inclusion-of-time-varying-covariates.html#warchest-data-in-r"><i class="fa fa-check"></i><b>7.2</b> Warchest Data in R</a><ul>
<li class="chapter" data-level="7.2.1" data-path="inclusion-of-time-varying-covariates.html"><a href="inclusion-of-time-varying-covariates.html#table-7.4"><i class="fa fa-check"></i><b>7.2.1</b> Table 7.4</a></li>
<li class="chapter" data-level="7.2.2" data-path="inclusion-of-time-varying-covariates.html"><a href="inclusion-of-time-varying-covariates.html#table-7.5"><i class="fa fa-check"></i><b>7.2.2</b> Table 7.5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html"><i class="fa fa-check"></i><b>8</b> Diagnostic Methods for the Event History Model</a><ul>
<li class="chapter" data-level="8.1" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#cabinet-data-in-r-2"><i class="fa fa-check"></i><b>8.1</b> Cabinet Data in R</a><ul>
<li class="chapter" data-level="8.1.1" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.1"><i class="fa fa-check"></i><b>8.1.1</b> Figure 8.1</a></li>
<li class="chapter" data-level="8.1.2" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.2"><i class="fa fa-check"></i><b>8.1.2</b> Figure 8.2</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#cabinet-data-in-stata-2"><i class="fa fa-check"></i><b>8.2</b> Cabinet Data in Stata</a><ul>
<li class="chapter" data-level="8.2.1" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.1-1"><i class="fa fa-check"></i><b>8.2.1</b> Figure 8.1</a></li>
<li class="chapter" data-level="8.2.2" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.2-1"><i class="fa fa-check"></i><b>8.2.2</b> Figure 8.2</a></li>
<li class="chapter" data-level="8.2.3" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.6"><i class="fa fa-check"></i><b>8.2.3</b> Figure 8.6</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#militarized-interventions-data-in-r-1"><i class="fa fa-check"></i><b>8.3</b> Militarized Interventions Data in R</a><ul>
<li class="chapter" data-level="8.3.1" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.3"><i class="fa fa-check"></i><b>8.3.1</b> Figure 8.3</a></li>
<li class="chapter" data-level="8.3.2" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.4"><i class="fa fa-check"></i><b>8.3.2</b> Figure 8.4</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#militarized-interventions-data-in-stata-1"><i class="fa fa-check"></i><b>8.4</b> Militarized Interventions Data in Stata</a><ul>
<li class="chapter" data-level="8.4.1" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.3-1"><i class="fa fa-check"></i><b>8.4.1</b> Figure 8.3</a></li>
<li class="chapter" data-level="8.4.2" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.4-1"><i class="fa fa-check"></i><b>8.4.2</b> Figure 8.4</a></li>
<li class="chapter" data-level="8.4.3" data-path="diagnostic-methods-for-the-event-history-model.html"><a href="diagnostic-methods-for-the-event-history-model.html#figure-8.5"><i class="fa fa-check"></i><b>8.4.3</b> Figure 8.5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-modeling-strategies-for-unobserved-heterogeneity.html"><a href="some-modeling-strategies-for-unobserved-heterogeneity.html"><i class="fa fa-check"></i><b>9</b> Some Modeling Strategies for Unobserved Heterogeneity</a><ul>
<li class="chapter" data-level="9.1" data-path="some-modeling-strategies-for-unobserved-heterogeneity.html"><a href="some-modeling-strategies-for-unobserved-heterogeneity.html#conflict-data-in-r"><i class="fa fa-check"></i><b>9.1</b> Conflict Data in R</a><ul>
<li class="chapter" data-level="9.1.1" data-path="some-modeling-strategies-for-unobserved-heterogeneity.html"><a href="some-modeling-strategies-for-unobserved-heterogeneity.html#table-9.1"><i class="fa fa-check"></i><b>9.1.1</b> Table 9.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="models-for-multiple-events.html"><a href="models-for-multiple-events.html"><i class="fa fa-check"></i><b>10</b> Models for Multiple Events</a></li>
<li class="chapter" data-level="11" data-path="the-social-sciences-and-event-history.html"><a href="the-social-sciences-and-event-history.html"><i class="fa fa-check"></i><b>11</b> The Social Sciences and Event History</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Event History Modeling: A Guide for Social Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="issues-in-model-selection" class="section level1">
<h1><span class="header-section-number">6</span> Issues in Model Selection</h1>
<p>This chapter makes use of data on the duration until state adoption of restrictive abortion legislation since the 1973 Roe vs. Wade Supreme Court decision (from Brace et al. 1999).</p>
<div id="restrictive-abortion-legislation-data-in-r" class="section level2">
<h2><span class="header-section-number">6.1</span> Restrictive Abortion Legislation Data in R</h2>
<p>Let’s load the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#-------Dataset</span>

adopt &lt;-<span class="st"> </span><span class="kw">read.dta</span>(<span class="st">&quot;~/Dropbox/github/liwu-gan.github.io/dta/adopt_singleevent.dta&quot;</span>)

<span class="co">#-------Data prepation</span>

<span class="co"># Create survival object for dv </span>

dv &lt;-<span class="st"> </span><span class="kw">Surv</span>(adopt<span class="op">$</span><span class="st">&#39;_t&#39;</span>, adopt<span class="op">$</span><span class="st">&#39;_d&#39;</span>)</code></pre></div>
<div id="table-6.1" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Table 6.1</h3>
<p>First, we run each of the models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The conditional logit model is the same as the exact discrete method we used earlier</span>

ed_mod &lt;-<span class="st"> </span><span class="kw">coxph</span>(dv <span class="op">~</span><span class="st"> </span>mooneymean, <span class="dt">data =</span> adopt, <span class="dt">ties =</span> <span class="st">&quot;exact&quot;</span>)

### Can&#39;t run Royston-Parmar model 


<span class="co"># Weibull P/H/</span>
weib_mod &lt;-<span class="st"> </span><span class="kw">survreg</span>(dv <span class="op">~</span><span class="st"> </span>mooneymean, <span class="dt">data =</span> adopt, <span class="dt">dist =</span> <span class="st">&quot;weibull&quot;</span>)</code></pre></div>
<p>Again, we have to convert the Weibull A.F.T. to a P.H. parameterization.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Conversion from Weibull A.F.T.  to P.H. </span>

intercept &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">50</span>)

adopt<span class="op">$</span>intercept &lt;-<span class="st"> </span>intercept

weib_mod1 &lt;-<span class="st"> </span><span class="kw">survreg</span>(dv <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>mooneymean <span class="op">+</span><span class="st"> </span>intercept, <span class="dt">data =</span> adopt)

weib_mod2 &lt;-<span class="st"> </span><span class="kw">survreg</span>(dv <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>intercept <span class="op">+</span><span class="st"> </span>mooneymean, <span class="dt">data =</span> adopt)

weib_mod1_ph &lt;-<span class="st"> </span><span class="kw">ConvertWeibull</span>(weib_mod1)

weib_mod2_ph &lt;-<span class="st"> </span><span class="kw">ConvertWeibull</span>(weib_mod2)

weib_ph &lt;-<span class="st"> </span><span class="kw">rbind</span>(weib_mod1_ph<span class="op">$</span>vars, weib_mod2_ph<span class="op">$</span>vars)

<span class="co"># Delete rows that are redundant/unnecessary </span>
weib_ph &lt;-<span class="st"> </span>weib_ph[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),]


weib_ph &lt;-<span class="st"> </span>weib_ph[<span class="kw">c</span>(<span class="st">&quot;mooneymean&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;intercept&quot;</span>),]

weib_ph</code></pre></div>
<pre><code>##              Estimate         SE
## mooneymean -0.2227881 0.08239561
## gamma       0.9830112 0.12000313
## intercept  -2.0966280 0.31945773</code></pre>
<p>Let’s format these models into a presentable table.</p>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<table cellspacing="0" style="border: none;">
<caption align="top" style="margin-bottom:0.3em;">
Models of Adoption of Restrictive Abortion Legislation
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Cox Model</b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Weibull Model</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Pre-Roe
</td>
<td style="padding-right: 12px; border: none;">
-0.22 (0.09)
</td>
<td style="padding-right: 12px; border: none;">
-0.22 (0.08)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Constant
</td>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
-2.10 (0.32)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
Log Likelihood
</td>
<td style="border-top: 1px solid black;">
-96.60
</td>
<td style="border-top: 1px solid black;">
-133.07
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
N
</td>
<td style="padding-right: 12px; border: none;">
50
</td>
<td style="padding-right: 12px; border: none;">
50
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Shape Parameter
</td>
<td style="border-bottom: 2px solid black;">
</td>
<td style="border-bottom: 2px solid black;">
0.98
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="4">
<span style="font-size:0.8em"></span>
</td>
</tr>
</table>
</div>
<div id="figure-6.1" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Figure 6.1</h3>
<p>We first calculate the baseline hazard for the Weibull.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Let&#39;s create lambda from the Weibull model we ran earlier</span>
  
lambda_base &lt;-<span class="st"> </span><span class="kw">unname</span>(<span class="kw">exp</span>(<span class="op">-</span>(weib_mod<span class="op">$</span>coef[<span class="dv">1</span>])))

p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>weib_mod<span class="op">$</span>scale

t &lt;-<span class="st"> </span>adopt<span class="op">$</span><span class="st">&#39;_t&#39;</span>

<span class="co"># We cangenerate the baseline hazard function, knowing that </span>
<span class="co"># h(t) = lambda * p * (lambda * t)^(p-1)</span>

haz_baseweib &lt;-<span class="st"> </span>lambda_base <span class="op">*</span><span class="st"> </span>p <span class="op">*</span><span class="st"> </span>(lambda_base <span class="op">*</span><span class="st"> </span>t)<span class="op">^</span>(p<span class="op">-</span><span class="dv">1</span>)

weib &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(t, haz_baseweib))</code></pre></div>
<p>We do the same for the Cox model we already ran earlier.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculates integrated baseline hazard, H(t)</span>

haz_rte &lt;-<span class="st"> </span><span class="kw">basehaz</span>(ed_mod, <span class="dt">centered =</span> <span class="ot">FALSE</span>)

<span class="co"># To get the baseline hazard, we calculate H(t) - H(t-1), which gives us the corresponding # value for all obs. except for the first. </span>

haz_cox &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">diff</span>(haz_rte<span class="op">$</span>hazard))

<span class="co"># Take out H(t) at t = 1 and merge with previous calculations</span>

row &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="fl">0.2208064</span>)
<span class="kw">colnames</span>(row) &lt;-<span class="st"> &quot;diff.haz_rte.hazard.&quot;</span>
haz_cox &lt;-<span class="st"> </span><span class="kw">rbind</span>(row, haz_cox)
<span class="kw">colnames</span>(haz_cox) &lt;-<span class="st"> &quot;baseline_hazard&quot;</span>

<span class="co"># Merge baseline hazards into master dataframe with integrated hazards</span>

haz_rte<span class="op">$</span>haz_cox &lt;-<span class="st"> </span>haz_cox

<span class="co">#Drop last row for graphical purposes</span>

haz_rte &lt;-<span class="st"> </span>haz_rte[<span class="op">-</span><span class="kw">c</span>(<span class="dv">16</span>), ]

### Calculate baseline hazard rate for Royston-Parmar model</code></pre></div>
<p>We are ready to plot now.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> haz_rte, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> haz_cox, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_step</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> weib, <span class="kw">aes</span>(<span class="dt">x =</span> t, <span class="dt">y =</span> haz_baseweib, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Hazard Functions&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Years Since Roe vs. Wade&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;Model&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Cox&quot;</span>, <span class="st">&quot;Weibull&quot;</span>), <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>))</code></pre></div>
<p><img src="event_history_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
</div>
</div>
<div id="restrictive-abortion-legislation-data-in-stata" class="section level2">
<h2><span class="header-section-number">6.2</span> Restrictive Abortion Legislation Data in Stata</h2>
<p>Let’s load the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">/</span><span class="er">*</span><span class="st"> </span>Dataset is adopt_singleevent.dta <span class="op">*</span><span class="er">/</span>

use <span class="st">&quot;~/Dropbox/github/liwu-gan.github.io/dta/adopt_singleevent.dta&quot;</span></code></pre></div>
<div id="table-6.1-1" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Table 6.1</h3>
<p>We begin by estimating the Cox and Weibull models, and storing the results to make a table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">*</span><span class="st"> </span>Cox model 

eststo clear 

eststo<span class="op">:</span><span class="st"> </span>stcox mooneymean, exactp nohr <span class="kw">basehc</span>(haz_cox)

<span class="op">*</span><span class="st"> </span>Weibull model

eststo<span class="op">:</span><span class="st"> </span>streg mooneymean, <span class="kw">dist</span>(weib) nohr

<span class="op">*</span><span class="st"> </span>Reset working directory to collect output

cd <span class="op">~</span><span class="er">/</span>Dropbox<span class="op">/</span>github<span class="op">/</span>liwu<span class="op">-</span>gan.github.io<span class="op">/</span>chapter6

<span class="op">*</span><span class="st"> </span>Generate regression table output <span class="cf">for</span> Cox and Weibull 

esttab using ch6_cox_weib.html, replace <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">coeflabel</span>(mooneymean <span class="st">&quot;Pre-Roe&quot;</span> _cons <span class="st">&quot;Constant&quot;</span>) <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">title</span>(Models of Adoption of Restrictive Abortion Legislation) <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">mtitles</span>(<span class="st">&quot;Cox Model&quot;</span> <span class="st">&quot;Weibull Model&quot;</span>) <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">eqlabels</span>(<span class="st">&quot;&quot;</span>, none) <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">b</span>(<span class="dv">2</span>) <span class="kw">se</span>(<span class="dv">2</span>) nostar <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">stats</span>(ll N, <span class="kw">label</span>(<span class="st">&quot;Log-Likelihood&quot;</span> <span class="st">&quot;&lt;em&gt;N&lt;/em&gt;&quot;</span>) <span class="kw">fmt</span>(<span class="dv">2</span> <span class="dv">0</span>)) </code></pre></div>
<div class="figure">
<img src="chapter6/ch6_cox_weib.png" />

</div>
<p>Let’s estimate the Royston-Parmar model in comparison, and display the results in a table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eststo clear 

eststo<span class="op">:</span>stpm mooneymean, <span class="kw">scale</span>(h) <span class="kw">df</span>(<span class="dv">3</span>)

<span class="op">*</span><span class="st"> </span>Generate regression table output <span class="cf">for</span> Royston<span class="op">-</span>Parmar model

esttab using ch6_rp.html, replace <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">coeflabel</span>(s0<span class="op">:</span>_cons <span class="st">&quot;Spline 1&quot;</span> s1<span class="op">:</span>_cons <span class="st">&quot;Spline 2&quot;</span> s2<span class="op">:</span>_cons <span class="st">&quot;Spline 3&quot;</span> xb<span class="op">:</span>mooneymean <span class="st">&quot;Pre-Roe&quot;</span> <span class="op">/</span><span class="er">//</span>
<span class="st">    </span>xb<span class="op">:</span>_cons <span class="st">&quot;Constant&quot;</span>) <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">title</span>(Models of Adoption of Restrictive Abortion Legislation) <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">mtitles</span>(<span class="st">&quot;Royston-Parmar Model&quot;</span>) <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">eqlabels</span>(<span class="st">&quot;&quot;</span>, none) <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">b</span>(<span class="dv">2</span>) <span class="kw">se</span>(<span class="dv">2</span>) nostar <span class="op">/</span><span class="er">//</span>
<span class="st">    </span><span class="kw">stats</span>(ll N, <span class="kw">label</span>(<span class="st">&quot;Log-Likelihood&quot;</span> <span class="st">&quot;&lt;em&gt;N&lt;/em&gt;&quot;</span>) <span class="kw">fmt</span>(<span class="dv">2</span> <span class="dv">0</span>)) </code></pre></div>
<div class="figure">
<img src="chapter6/ch6_rp.png" />

</div>
</div>
<div id="figure-6.1-1" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Figure 6.1</h3>
<p>We already computed the baseline hazard for the Cox model earlier in the regression equation, so now we compute the baseline hazards for the Royston-Parmar and Weibull models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">*</span><span class="st"> </span>Compute baseline hazard <span class="cf">for</span> Royston<span class="op">-</span>Parmar model 

predict haz_rp, haz zero

<span class="op">*</span><span class="st"> </span>Compute baseline hazard <span class="cf">for</span> Weibull based on P.H. parameterization.

streg mooneymean, <span class="kw">dist</span>(weib) time

<span class="op">*</span><span class="st"> </span>First, note that lambda=<span class="kw">exp</span>(<span class="op">-</span>beta<span class="st">&#39;x).  We can compute lambda for each confict type.</span>

<span class="st">gen lambda_base=exp(-(_b[_cons])) if e(sample)</span>

<span class="st">* Second, note that h(t)=lambda*p*(lambda*t)^(p-1).  We can generate the hazard rate for the baseline.</span>

<span class="st">gen haz_weib=lambda_base*e(aux_p)*(lambda_base*yrtoadp)^(e(aux_p)-1)</span>

<span class="st">twoway (line haz_rp yrtoadp, sort lpattern(solid)) (line haz_weib yrtoadp, sort lpattern(solid)) ///</span>
<span class="st">    (line haz_cox yrtoadp, sort connect(stairstep) lpattern(solid)), ///</span>
<span class="st">    legend(off) ///</span>
<span class="st">    xtitle(&quot;Years Since Roe vs. Wade&quot;) ///</span>
<span class="st">    title(&quot;Hazard Functions&quot;, position(11)) ///</span>
<span class="st">    scheme(s2mono) graphregion(color(white) icolor(none)) ///</span>
<span class="st">    saving(hazadopt.gph, replace)</span>

<span class="st">graph export ch6_hazadopt.png, replace</span></code></pre></div>
<p><img src="chapter6/ch6_hazadopt.png" />{</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="models-for-discrete-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inclusion-of-time-varying-covariates.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
